<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Family 2-Week Calendar</title>
<style>
  body {
    background: transparent;
    font-family: "Helvetica Neue", sans-serif;
    color: white;
    margin: 0;
    padding: 20px;
  }
  h2 {
    text-align: center;
    font-weight: 300;
    margin-bottom: 15px;
    font-size: 36px;
  }

  /* Calendar grid */
  .calendar {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    grid-auto-rows: 1fr;
    gap: 10px;
  }

  .day {
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 6px;
    padding: 8px;
    background: rgba(255,255,255,0.05);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    min-height: 250px;
  }

  .date {
    font-size: 20px;
    font-weight: 500;
    margin-bottom: 8px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    padding-bottom: 4px;
  }

  .event {
    font-size: 16px;
    margin-bottom: 4px;
    border-left: 4px solid transparent;
    padding-left: 4px;
    line-height: 1.2;
  }

  /* Family member colors */
  .mom { border-color: #ff99c8; }
  .dad { border-color: #99c9ff; }
  .callan { border-color: #ffd166; }
  .maren { border-color: #06d6a0; }
  .default { border-color: #cccccc; }

  /* Weekday header */
  .weekday-header {
    grid-column: span 7;
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    text-align: center;
    font-weight: 500;
    margin-bottom: 6px;
    opacity: 0.9;
  }

  .weekday-header div {
    font-size: 18px;
    letter-spacing: 0.5px;
  }
</style>
</head>
<body>
  <h2>Family Calendar (Next 2 Weeks)</h2>
  <div class="weekday-header" id="weekdayHeader"></div>
  <div class="calendar" id="calendar"></div>

  <script>
    const ICS_URL = 'https://example.com/family.ics'; // Replace with your calendar feed URL

    async function loadCalendar() {
      const res = await fetch(ICS_URL);
      const text = await res.text();
      const events = parseICS(text);
      renderCalendar(events);
    }

    function parseICS(ics) {
      const events = [];
      const lines = ics.split(/\r?\n/);
      let event = null;
      for (let line of lines) {
        if (line.startsWith('BEGIN:VEVENT')) event = {};
        else if (line.startsWith('END:VEVENT')) {
          if (event) events.push(event);
          event = null;
        } else if (event) {
          if (line.startsWith('SUMMARY:')) event.summary = line.replace('SUMMARY:', '').trim();
          if (line.startsWith('DTSTART')) event.start = parseDate(line);
        }
      }
      return events
        .filter(e => e.start >= new Date() && e.start <= addDays(new Date(), 14))
        .sort((a, b) => a.start - b.start);
    }

    function parseDate(line) {
      const dt = line.split(':')[1];
      return new Date(dt);
    }

    function addDays(date, days) {
      const d = new Date(date);
      d.setDate(d.getDate() + days);
      return d;
    }

    function getMemberClass(title) {
      const t = title.toLowerCase();
      if (t.includes('maren')) return 'maren';
      if (t.includes('callan')) return 'callan';
      if (t.includes('mom')) return 'mom';
      if (t.includes('dad')) return 'dad';
      return 'default';
    }

    function renderCalendar(events) {
      const container = document.getElementById('calendar');
      const header = document.getElementById('weekdayHeader');
      const today = new Date();
      const days = [...Array(14).keys()].map(i => addDays(today, i));

      // Weekday header (Monâ€“Sun)
      const weekdays = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
      header.innerHTML = weekdays.map(d => `<div>${d}</div>`).join('');

      container.innerHTML = days.map(d => {
        const dayEvents = events.filter(e => e.start.toDateString() === d.toDateString());
        const formattedDate = d.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });
        return `
          <div class="day">
            <div class="date">${formattedDate}</div>
            ${dayEvents.length ? dayEvents.map(e =>
              `<div class="event ${getMemberClass(e.summary)}">${e.summary}</div>`
            ).join('') : `<div class="event default">No events</div>`}
          </div>
        `;
      }).join('');
    }

    loadCalendar();
  </script>
</body>
</html>
